@using WebTIGA;
@model WebTIGA.Models.ContenedorModelos
@{
    ViewBag.Title = "ReporteStatusActividades";
    Layout = "~/Views/Shared/_Layout_Resultado_Auditoria.cshtml";
}


<div class="card shadow mb-4">
    <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-dark text-center">Reporte de Status de Actividades</h6>
    </div>

    <div class="card-body">
        @using (Html.BeginForm())
        {
        <div class="row justify-content-center">

            <div class="col-lg-3">
                Plan Anual: <br />
                <select class="form-control" id="Plan" name="idPlanAnual">
                    @foreach (var Item in Model.DD_PlanAnual)
                    {
                        if (Item.IdPlanAnual == ViewBag.IdPlanAnualSeleccionado)
                        {
                            <option value="@Item.IdPlanAnual" selected>@Item.Nombre</option>
                        }
                        else
                        {
                            <option value="@Item.IdPlanAnual">@Item.Nombre</option>
                        }
                    }
                </select>
            </div>

            <div class="col-lg-3">
                Negocio: <br />
                <select class="form-control" id="Negocio" name="idNegocio">
                    @foreach (var Item in Model.DPA_Negocio)
                    {
                        if (Item.ID_Negocio == ViewBag.IdNegocioSeleccionado)
                        {
                            <option value="@Item.ID_Negocio" selected>@Item.Negocio</option>
                        }
                        else
                        {
                            <option value="@Item.ID_Negocio">@Item.Negocio</option>
                        }
                    }
                </select>
            </div>            
            <div class="col-lg-3">
                <br />
                <button type="submit" class="btn btn-info btn-reporte mr-2">
                    <i class="fas fa-filter"></i> Filtrar
                </button>
                <a type="button" class="btn btn-reporte btn-success" href="@Url.Action("DescargarReporteStatusActividades", "ResultadoAuditoria", new { idPlanAnual = ViewBag.IdPlanAnualSeleccionado, idNegocio = ViewBag.IdNegocioSeleccionado})">
                    <i class="fas fa-file-excel"></i> Descargar Reporte
                </a>
            </div>
        </div>
        }

        <div class="table-responsive mt-4">
            <table class="table table-bordered table-hover display tabla-reporte">
                <thead class="thead-dark">
                    <tr>
                        <th class="text-center align-middle"> Informe </th>
                        <th class="text-center align-middle"> Código </th>
                        <th class="text-center align-middle"> Evaluación </th>
                        <th class="text-center align-middle"> Estado </th>
                        <th class="text-center align-middle"> Tipo </th>
                        <th class="text-center align-middle"> Fecha Inicio Plan </th>
                        <th class="text-center align-middle"> Fecha Fin Plan </th>
                        <th class="text-center align-middle"> Actividad </th>
                        <th class="text-center align-middle"> Fecha de Emisión </th>
                        <th class="text-center align-middle"> Último Día </th>
                        <th class="text-center align-middle"> Fecha Ejecución Real </th>
                        <th class="text-center align-middle"> Fecha Revisado </th>
                        <th class="text-center align-middle"> Cantidad de Sprints </th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.SP_RA_REPORTE_STATUS_ACTIVIDADES)
                    {
                    <tr>
                        <td class="text-nowrap"> <span>@item.Informe</span> </td>
                        <td class="text-nowrap"> <span>@item.Codigo</span> </td>
                        <td class="text-nowrap"> <span>@item.Evaluacion</span> </td>
                        <td class="text-nowrap"> <span>@item.Estado</span> </td>
                        <td class="text-nowrap"> <span>@item.Tipo</span> </td>
                        <td class="text-center text-nowrap"> <span>@(item.Fecha_Inicio_Plan != null ? Convert.ToDateTime(item.Fecha_Inicio_Plan).ToShortDateString() : "-") </span> </td>
                        <td class="text-center text-nowrap"> <span>@(item.Fecha_Fin_Plan != null ? Convert.ToDateTime(item.Fecha_Fin_Plan).ToShortDateString() : "-") </span> </td>
                        <td class="text-nowrap"> <span>@item.Actividad</span> </td>
                        <td class="text-center text-nowrap"> <span>@(item.Fecha_Emision != null ? Convert.ToDateTime(item.Fecha_Emision).ToShortDateString() : "-") </span> </td>
                        <td class="text-center text-nowrap"> <span>@(item.Ultimo_Dia != null ? Convert.ToDateTime(item.Ultimo_Dia).ToShortDateString() : "-") </span> </td>
                        <td class="text-center text-nowrap"> <span>@(item.Fecha_Ejecucion_Real != null ? Convert.ToDateTime(item.Fecha_Ejecucion_Real).ToShortDateString() : "-") </span> </td>
                        <td class="text-center text-nowrap"> <span>@(item.Fecha_Revisado != null ? Convert.ToDateTime(item.Fecha_Revisado).ToShortDateString() : "-") </span> </td>
                        <td class="text-center text-nowrap"> <span>@item.Cantidad_Sprints</span> </td>
                    </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>




